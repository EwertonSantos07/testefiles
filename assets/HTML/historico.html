<!-- Estrutura Inicial da Página-->
<!DOCTYPE html>
<html lang="en">
    <head>

        <!-- Session Storage Verification -->
        <script>
            const islocalEnvironment = sessionStorage.getItem('localEnvironment')
            const statusADM = sessionStorage.getItem('ADMstatus')
            const intlocalEnvironment = parseInt(islocalEnvironment)
            const resultInt = (intlocalEnvironment === 1)
            const resultADM = (statusADM === 'true');
            
            if(sessionStorage.getItem("statusConsole") === 'true') {
                console.log("Environment: ", resultInt);
                console.log("ADM: ", resultADM);
            } 

            if (resultInt === true && resultADM === false) {
                
                // Tag GA4
                const ga4MeasurementId = 'G-28WKJ8L6QV';

                // Head Element GA4
                const script1 = document.createElement("script")
                script1.async = true
                script1.src = `https://www.googletagmanager.com/gtag/js?id=${ga4MeasurementId}`
                document.head.appendChild(script1)

                // Data Layer GA4
                const script2 = document.createElement("script")
                script2.textContent = `
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){dataLayer.push(arguments);}
                    gtag('js', new Date());

                    gtag('config', '${ga4MeasurementId}')
                `;
                document.head.appendChild(script2);

                // Google Tag Manager GTM
                (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                })(window,document,'script','dataLayer','GTM-KDCXQ28J');

                
                if(sessionStorage.getItem("statusConsole") === 'true') {
                    console.log("sobre.html: GA4 e GTM habilitados para essa sessão!");
                } 
            } else {
                if(sessionStorage.getItem("statusConsole") === 'true') {
                    console.log("sobre.html: Ambiente de testes ou ADM em produção, não habilitar TAGS Google!")
                }
            }
        </script>

        <script>
            const currentEnvironment = sessionStorage.getItem("proEnvironment")
            const intproEnvironment = parseInt(currentEnvironment)
            const linkElement = document.createElement('link');
            linkElement.rel = 'stylesheet';
            linkElement.type = 'text/css';
            if (intproEnvironment === -1) { //Live Server
                linkElement.href = "/assets/CSS/2-historico/0-historico.css";
            } else if (intproEnvironment === 0) { //testefiles
                linkElement.href = "/testefiles/assets/CSS/2-historico/0-historico.css";
            } else if (intproEnvironment === 1) {
                linkElement.href = "/criacao-de-sites/assets/CSS/2-historico/0-historico.css";
            }
            document.head.appendChild(linkElement);
            if(sessionStorage.getItem("statusConsole") === 'true') {
                console.log("LinkElement: ", linkElement)
            }
        </script>

        <meta charset="UTF-8">
        <meta 
            name="viewport" 
            content="width=device-width, 
                initial-scale=1.0">

        <meta
            name="description"
            content="Ewerton Santos é um profissional especializado em criação de sites em Curitiba, PR. Desenvolvemos websites personalizados e responsivos para empresas e indivíduos. Solicite um orçamento!">

        <meta 
            name="keywords" 
            content="criação de sites, desenvolvimento web, web designer Curitiba, sites profissionais, orçamento sites">

        <title>Histórico de Criação de Sites | Ewerton Santos - Web Designer Profissional</title>

        <link rel="stylesheet" 
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    </head>

    <body>

        <!-- Iframe GTM -->
        <script>
            const islocalEnvironment2 = sessionStorage.getItem('localEnvironment')
            const statusADM2 = sessionStorage.getItem('ADMstatus')
            const intlocalEnvironment2 = parseInt(islocalEnvironment2)
            const resultInt2 = (intlocalEnvironment2 === 1)
            const resultADM2 = (statusADM2 === 'true');

            if (resultInt2 === true && resultADM2 === false) {

                // Google Tag Manager (noscript)
                const noScript = document.createElement("noscript")
                const eliframe = document.createElement("iframe")
                eliframe.src = "https://www.googletagmanager.com/ns.html?id=GTM-KDCXQ28J"
                eliframe.height = "0"
                eliframe.width = "0"
                eliframe.style.display = "none"
                eliframe.style.visibility = "hidden"
                noScript.appendChild(eliframe)
                document.body.prepend(noScript)

                if(sessionStorage.getItem("statusConsole") === 'true') {
                    console.log("sobre.html: Iframe GTM ativo!!!")
                }
            } else {
                if(sessionStorage.getItem("statusConsole") === 'true') {
                    console.log("sobre.html: Iframe noscript GTM desativado!")
                }
            }
        </script>

        <!-- Section Provisório aviso Manutenção -->
        <section
            id="historico-de-trabalhos"
            data-link="historico-de-trabalhos"
            class="section-historico">
        
            <h3 class="hi-h3">
                Histórico de Trabalhos
            </h3>

            <div class="hi-div-prompt">
                <p class="hi-p-aviso">
                    C:\Aviso> Conexão com banco de dados sendo configurada, volte mais tarde...
                </p>
            </div>

            <button class="hist-btn">
                &lt;
                <i class="fa">
                    &#xf232;
                </i>
                Informações &gt;
            </button>
        
        </section>

        <!-- Section Clientes -->
        <!-- <section 
            id="historico-de-trabalhos" 
            data-link="historico-de-trabalhos" 
            class="section-historico">
            
            <h3 class="hi-h3">
                Histórico de Trabalhos
            </h3>

            <div class="hi-div-infos">
                <img 
                    class="hi-img"
                    src= ""
                    alt="">
                
                <p class="hi-p">
                    <span
                        id="content-descricao"></span>
                    <a 
                        id="content-link"
                        href="" 
                        target="_blank" 
                        title="">
                        Clique aqui e saiba mais.
                    </a>
                </p>
            </div>

        </section> -->

        <!-- <script>

            //IP para teste local: 127.0.0.1
            //IP para teste no servidor: 192.168.15.38
            //const ipLocal = '127.0.0.1'; //Localhost
            //const ipLocal = '191.255.186.168'; //IP Público Dinâmico
            const ipLocal = "techinfo.webredirect.org" //Sub-domínio
            const urlConteudo = `https://${ipLocal}:5000/api/conteudo`;

            // Função para buscar e exibir dados de texto
            async function buscarConteudo() {
                return new Promise(async (resolve) => {
                    const response = await fetch(urlConteudo)
                    console.log("Resposta:", response)
                    console.log("Continuando...")

                    if (!response.ok) {
                        throw new Error(`Erro na requisição: ${response.status} - ${response.statusText}`);
                    }

                    const retrive_data = await response.json();
                    console.log("Dados recebidos:", retrive_data); 
                    console.log("ID: ", retrive_data.ID); 

                    document.getElementById('content-descricao').textContent = retrive_data.DESCRICAO;
                    const cliqueAqui = document.getElementById("content-link")
                    cliqueAqui.href = retrive_data.LINK_OFICIAL;
                    resolve(retrive_data.PATH_LOGO)
                })
            }

            // Função para buscar e exibir dados de imagem
            async function buscarImgPath(ip, PathImg) {
                return new Promise(async (resolve) => {
                    const urlLogo = `https://${ipLocal}:5000/logos/${PathImg}`;
                    const response2 = await fetch(urlLogo)
                    console.log(response2)

                    const imgID = document.querySelector(".hi-img")
                    imgID.src = urlLogo
                })
            }
                
            // Chamar as funções quando a página carregar
            window.onload = async function() {
                const pathImagem = await buscarConteudo();
                const indexImg = await buscarImgPath(ipLocal, pathImagem);
            };
        </script> -->

        <script>
            // Função para notificar o documento pai que o conteúdo do iframe está pronto
            function notifyParentIframeReady() {
                // Verifica se a janela atual está dentro de um iframe e se tem um pai
                if (window.parent && window.parent !== window) {
                    
                    //Definindo Domínio Atual
                    const currentDomain = sessionStorage.getItem("currentDomain")

                    // Permissions Origins
                    const parentOrigins = [
                        currentDomain
                    ];

                    //Enviando sinal para origem
                    parentOrigins.forEach(origin => {
                        window.parent.postMessage('iframeContentReady', origin); 
                        if(sessionStorage.getItem("statusConsole") === 'true') {
                            console.log(`%cTentando enviar 'iframeContentReady' para origem: ${origin}`, "color: gray;");
                        }
                    })

                    // Status
                    if(sessionStorage.getItem("statusConsole") === 'true') {
                        console.log("%cNotificação 'iframeContentReady' enviada para o pai (verifique o console do pai para confirmação).", "color: blue;");
                    }
                }
            }
            window.addEventListener('load', notifyParentIframeReady);
        </script>

    </body>
</html>